"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ImageToolbar=void 0;const react_1=__importDefault(require("react")),mobx_react_lite_1=require("mobx-react-lite"),core_1=require("@blueprintjs/core"),element_container_1=require("./element-container"),styled_1=__importDefault(require("../utils/styled")),filters_picker_1=__importDefault(require("./filters-picker")),flip_button_1=__importDefault(require("./flip-button")),flags_1=require("../utils/flags"),remove_background_button_1=require("./remove-background-button"),l10n_1=require("../utils/l10n"),FitButton=({element:e,store:t})=>react_1.default.createElement(core_1.Button,{text:(0,l10n_1.t)("toolbar.fitToBackground"),minimal:!0,onClick:()=>{e.set({x:-e.page.bleed,y:-e.page.bleed,width:t.width+2*e.page.bleed,height:t.height+2*e.page.bleed,rotation:0,cropX:0,cropY:0,cropWidth:1,cropHeight:1})}}),CropButton=({element:e,store:t})=>react_1.default.createElement(core_1.Button,{text:(0,l10n_1.t)("toolbar.crop"),minimal:!0,onClickCapture:t=>{t.stopPropagation(),e.toggleCropMode(!0)}}),RemoveClipButton=({element:e,store:t})=>react_1.default.createElement(core_1.Button,{text:(0,l10n_1.t)("toolbar.removeClip"),minimal:!0,onClickCapture:t=>{e.set({clipSrc:""})}}),PROPS_MAP={flip:flip_button_1.default,filter:filters_picker_1.default,fitToBackground:FitButton,crop:CropButton,removeClip:RemoveClipButton,removeBackground:remove_background_button_1.RemoveBackgroundButton},Container=(0,styled_1.default)("div")`
  @media screen and (max-width: 500px) {
    width: auto;
  }
`;exports.ImageToolbar=(0,mobx_react_lite_1.observer)((({store:e,hideImageFlip:t,hideImageEffects:r,hideImageCrop:o,hideImageFit:l})=>{const a=e.selectedElements[0],i=a._cropModeEnabled,n=react_1.default.useRef({});react_1.default.useEffect((()=>{i&&(n.current={x:a.x,y:a.y,width:a.width,height:a.height,cropX:a.cropX,cropY:a.cropY,cropWidth:a.cropWidth,cropHeight:a.cropHeight})}),[i]);const c=[!t&&"flip",!r&&"filter",!l&&"fitToBackground",!o&&"crop",a.clipSrc&&"removeClip",flags_1.flags.removeBackgroundEnabled&&"removeBackground"].filter((e=>!!e));return react_1.default.createElement(react_1.default.Fragment,null,!i&&react_1.default.createElement(element_container_1.ElementContainer,{items:c,itemRender:t=>{const r=PROPS_MAP[t];return react_1.default.createElement(r,{element:a,store:e,key:t})}}),i&&react_1.default.createElement(core_1.Navbar.Group,null,react_1.default.createElement(core_1.Button,{text:(0,l10n_1.t)("toolbar.cropDone"),minimal:!0,icon:"tick",onClickCapture:e=>{a.toggleCropMode(!1)}}),react_1.default.createElement(core_1.Button,{text:(0,l10n_1.t)("toolbar.cropCancel"),minimal:!0,icon:"cross",onClickCapture:e=>{a.set(Object.assign({},n.current)),a.toggleCropMode(!1)}})))})),exports.default=exports.ImageToolbar;